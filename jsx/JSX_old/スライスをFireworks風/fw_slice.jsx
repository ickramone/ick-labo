//copyright "Dearps" Sho Miuratry{function DearpsNull(){// =======================================================var id301 = charIDToTypeID( "Mk  " );    var desc62 = new ActionDescriptor();    var id302 = charIDToTypeID( "null" );        var ref39 = new ActionReference();        var id303 = stringIDToTypeID( "contentLayer" );        ref39.putClass( id303 );    desc62.putReference( id302, ref39 );    var id304 = charIDToTypeID( "Usng" );        var desc63 = new ActionDescriptor();        var id305 = charIDToTypeID( "Nm  " );        desc63.putString( id305, "Dearps NULL" );        var id306 = charIDToTypeID( "Md  " );        var id307 = charIDToTypeID( "BlnM" );        var id308 = charIDToTypeID( "Mltp" );        desc63.putEnumerated( id306, id307, id308 );        var id309 = charIDToTypeID( "Clr " );        var id310 = charIDToTypeID( "Clr " );        var id311 = charIDToTypeID( "Grn " );        desc63.putEnumerated( id309, id310, id311 );        var id312 = charIDToTypeID( "Type" );            var desc64 = new ActionDescriptor();            var id313 = charIDToTypeID( "Clr " );                var desc65 = new ActionDescriptor();                var id314 = charIDToTypeID( "Rd  " );                desc65.putDouble( id314, 5.999908 );                var id315 = charIDToTypeID( "Grn " );                desc65.putDouble( id315, 255.000000 );                var id316 = charIDToTypeID( "Bl  " );                desc65.putDouble( id316, 0.000000 );            var id317 = charIDToTypeID( "RGBC" );            desc64.putObject( id313, id317, desc65 );        var id318 = stringIDToTypeID( "solidColorLayer" );        desc63.putObject( id312, id318, desc64 );    var id319 = stringIDToTypeID( "contentLayer" );    desc62.putObject( id304, id319, desc63 );executeAction( id301, desc62, DialogModes.NO );// CS2用var id320 = charIDToTypeID( "setd" );    var desc66 = new ActionDescriptor();    var id321 = charIDToTypeID( "null" );        var ref40 = new ActionReference();        var id322 = charIDToTypeID( "Chnl" );        var id323 = charIDToTypeID( "fsel" );        ref40.putProperty( id322, id323 );    desc66.putReference( id321, ref40 );    var id324 = charIDToTypeID( "T   " );        var ref41 = new ActionReference();        var id325 = charIDToTypeID( "Chnl" );        var id326 = charIDToTypeID( "Ordn" );        var id327 = charIDToTypeID( "Trgt" );        ref41.putEnumerated( id325, id326, id327 );    desc66.putReference( id324, ref41 );executeAction( id320, desc66, DialogModes.NO );// CS4用var idsetd = charIDToTypeID( "setd" );    var desc134 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref98 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idfsel = charIDToTypeID( "fsel" );        ref98.putProperty( idChnl, idfsel );    desc134.putReference( idnull, ref98 );    var idT = charIDToTypeID( "T   " );        var ref99 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idChnl = charIDToTypeID( "Chnl" );        var idMsk = charIDToTypeID( "Msk " );        ref99.putEnumerated( idChnl, idChnl, idMsk );    desc134.putReference( idT, ref99 );executeAction( idsetd, desc134, DialogModes.NO );}try {// 選択範囲あるかないか// =======================================================var id1330 = charIDToTypeID( "Mk  " );    var desc261 = new ActionDescriptor();    var id1331 = charIDToTypeID( "null" );        var ref165 = new ActionReference();        var id1332 = charIDToTypeID( "Lyr " );        ref165.putClass( id1332 );    desc261.putReference( id1331, ref165 );    var id1333 = charIDToTypeID( "Usng" );        var desc262 = new ActionDescriptor();        var id1334 = charIDToTypeID( "Nm  " );        desc262.putString( id1334, "Dearps NULL" );    var id1335 = charIDToTypeID( "Lyr " );    desc261.putObject( id1333, id1335, desc262 );executeAction( id1330, desc261, DialogModes.NO );// =======================================================var id1336 = charIDToTypeID( "Trnf" );    var desc263 = new ActionDescriptor();    var id1337 = charIDToTypeID( "null" );        var ref166 = new ActionReference();        var id1338 = charIDToTypeID( "Chnl" );        var id1339 = charIDToTypeID( "fsel" );        ref166.putProperty( id1338, id1339 );    desc263.putReference( id1337, ref166 );    var id1340 = charIDToTypeID( "FTcs" );    var id1341 = charIDToTypeID( "QCSt" );    var id1342 = charIDToTypeID( "Qcsa" );    desc263.putEnumerated( id1340, id1341, id1342 );    var id1343 = charIDToTypeID( "Ofst" );        var desc264 = new ActionDescriptor();        var id1344 = charIDToTypeID( "Hrzn" );        var id1345 = charIDToTypeID( "#Pxl" );        desc264.putUnitDouble( id1344, id1345, 0.000000 );        var id1346 = charIDToTypeID( "Vrtc" );        var id1347 = charIDToTypeID( "#Pxl" );        desc264.putUnitDouble( id1346, id1347, 0.000000 );    var id1348 = charIDToTypeID( "Ofst" );    desc263.putObject( id1343, id1348, desc264 );    var id1349 = charIDToTypeID( "Wdth" );    var id1350 = charIDToTypeID( "#Prc" );    desc263.putUnitDouble( id1349, id1350, 100.000000 );executeAction( id1336, desc263, DialogModes.NO );// =======================================================var id1351 = charIDToTypeID( "Dlt " );    var desc265 = new ActionDescriptor();    var id1352 = charIDToTypeID( "null" );        var ref167 = new ActionReference();        var id1353 = charIDToTypeID( "Lyr " );        var id1354 = charIDToTypeID( "Ordn" );        var id1355 = charIDToTypeID( "Trgt" );        ref167.putEnumerated( id1353, id1354, id1355 );    desc265.putReference( id1352, ref167 );executeAction( id1351, desc265, DialogModes.NO );}catch (e) {// =======================================================var id1074 = charIDToTypeID( "setd" );    var desc184 = new ActionDescriptor();    var id1075 = charIDToTypeID( "null" );        var ref133 = new ActionReference();        var id1076 = charIDToTypeID( "Chnl" );        var id1077 = charIDToTypeID( "fsel" );        ref133.putProperty( id1076, id1077 );    desc184.putReference( id1075, ref133 );    var id1078 = charIDToTypeID( "T   " );        var desc185 = new ActionDescriptor();        var id1079 = charIDToTypeID( "Top " );        var id1080 = charIDToTypeID( "#Pxl" );        desc185.putUnitDouble( id1079, id1080, 0.000000 );        var id1081 = charIDToTypeID( "Left" );        var id1082 = charIDToTypeID( "#Pxl" );        desc185.putUnitDouble( id1081, id1082, 0.000000 );        var id1083 = charIDToTypeID( "Btom" );        var id1084 = charIDToTypeID( "#Pxl" );        desc185.putUnitDouble( id1083, id1084, 10.000000 );        var id1085 = charIDToTypeID( "Rght" );        var id1086 = charIDToTypeID( "#Pxl" );        desc185.putUnitDouble( id1085, id1086, 10.000000 );    var id1087 = charIDToTypeID( "Rctn" );    desc184.putObject( id1078, id1087, desc185 );executeAction( id1074, desc184, DialogModes.NO );// =======================================================var id1088 = charIDToTypeID( "Trnf" );    var desc186 = new ActionDescriptor();    var id1089 = charIDToTypeID( "null" );        var ref134 = new ActionReference();        var id1090 = charIDToTypeID( "Chnl" );        var id1091 = charIDToTypeID( "fsel" );        ref134.putProperty( id1090, id1091 );    desc186.putReference( id1089, ref134 );    var id1092 = charIDToTypeID( "FTcs" );    var id1093 = charIDToTypeID( "QCSt" );    var id1094 = charIDToTypeID( "Qcsa" );    desc186.putEnumerated( id1092, id1093, id1094 );    var id1095 = charIDToTypeID( "Ofst" );        var desc187 = new ActionDescriptor();        var id1096 = charIDToTypeID( "Hrzn" );        var id1097 = charIDToTypeID( "#Prc" );        desc187.putUnitDouble( id1096, id1097, 50 );        var id1098 = charIDToTypeID( "Vrtc" );        var id1099 = charIDToTypeID( "#Prc" );        desc187.putUnitDouble( id1098, id1099, 50 );    var id1100 = charIDToTypeID( "Ofst" );    desc186.putObject( id1095, id1100, desc187 );    var id1101 = charIDToTypeID( "Wdth" );    var id1102 = charIDToTypeID( "#Prc" );    desc186.putUnitDouble( id1101, id1102, 1610.000000 );    var id1103 = charIDToTypeID( "Hght" );    var id1104 = charIDToTypeID( "#Prc" );    desc186.putUnitDouble( id1103, id1104, 1000.000000 );executeAction( id1088, desc186, DialogModes.ALL );}DearpsNull();function sliceLog() {var sliceDLG = new createDialog_DLG();initializeBuilder(sliceDLG);if(runBuilder(sliceDLG)){	runProcessing(sliceDLG);}// ===========================================================================function createDialog_DLG(){	var dialogResource = "dialog { text:'スライス作成', bounds:[0, 0, 344, 84], "	dialogResource += " pnl: Panel { text:'スライス名を入力してください', bounds:[15, 8, 227, 69], "	dialogResource += " str: StaticText { text:'スライス名', bounds:[12, 24, 74, 37],  }, "	dialogResource += " slicename: EditText { bounds:[77, 23, 198, 41],  }, "	dialogResource += " }," 	dialogResource += " build: Button { text:'確定', bounds:[244, 29, 328, 53],  }, "	dialogResource += " }";	var dlg = new Window( dialogResource );	dlg.center();	return dlg;}// ダイアログ（ボタンを押したときなどの動作設定）=============================function initializeBuilder(builder){	with(builder){		//ここに必須入力チェックなど						//初期値		pnl.slicename.text = "";	//スライス名				//ボタンイベント		build.onClick = function(){ this.parent.close( true ); };	}}// ダイアログ（起動・実行）===================================================function runBuilder(builder){  return builder.show();}// ===========================================================================// 実行したい処理=============================================================function runProcessing(builder){var slice;	with(builder){		slice =pnl.slicename.text;	//幅	}// =======================================================var id32 = charIDToTypeID( "Mk  " );    var desc5 = new ActionDescriptor();    var id33 = charIDToTypeID( "null" );        var ref2 = new ActionReference();        var id34 = stringIDToTypeID( "contentLayer" );        ref2.putClass( id34 );    desc5.putReference( id33, ref2 );    var id35 = charIDToTypeID( "Usng" );        var desc6 = new ActionDescriptor();        var id36 = charIDToTypeID( "Nm  " );        desc6.putString( id36, "未設定" );        var id37 = charIDToTypeID( "Md  " );        var id38 = charIDToTypeID( "BlnM" );        var id39 = charIDToTypeID( "Mltp" );        desc6.putEnumerated( id37, id38, id39 );        var id40 = charIDToTypeID( "Clr " );        var id41 = charIDToTypeID( "Clr " );        var id42 = charIDToTypeID( "Grn " );        desc6.putEnumerated( id40, id41, id42 );        var id43 = charIDToTypeID( "Type" );            var desc7 = new ActionDescriptor();            var id44 = charIDToTypeID( "Clr " );                var desc8 = new ActionDescriptor();                var id45 = charIDToTypeID( "Rd  " );                desc8.putDouble( id45, 6.007782 );                var id46 = charIDToTypeID( "Grn " );                desc8.putDouble( id46, 255.000000 );                var id47 = charIDToTypeID( "Bl  " );                desc8.putDouble( id47, 0.000000 );            var id48 = charIDToTypeID( "RGBC" );            desc7.putObject( id44, id48, desc8 );        var id49 = stringIDToTypeID( "solidColorLayer" );        desc6.putObject( id43, id49, desc7 );    var id50 = stringIDToTypeID( "contentLayer" );    desc5.putObject( id35, id50, desc6 );executeAction( id32, desc5, DialogModes.NO );// =======================================================var id51 = charIDToTypeID( "slct" );    var desc9 = new ActionDescriptor();    var id52 = charIDToTypeID( "null" );        var ref3 = new ActionReference();        var id53 = charIDToTypeID( "Lyr " );        ref3.putName( id53, "未設定" );    desc9.putReference( id52, ref3 );    var id54 = charIDToTypeID( "MkVs" );    desc9.putBoolean( id54, false );executeAction( id51, desc9, DialogModes.NO );// 名称設定var id239 = charIDToTypeID( "setd" );    var desc44 = new ActionDescriptor();    var id240 = charIDToTypeID( "null" );        var ref23 = new ActionReference();        var id241 = charIDToTypeID( "Lyr " );        var id242 = charIDToTypeID( "Ordn" );        var id243 = charIDToTypeID( "Trgt" );        ref23.putEnumerated( id241, id242, id243 );    desc44.putReference( id240, ref23 );    var id244 = charIDToTypeID( "T   " );        var desc45 = new ActionDescriptor();        var id245 = charIDToTypeID( "Nm  " );        desc45.putString( id245, slice );    var id246 = charIDToTypeID( "Lyr " );    desc44.putObject( id244, id246, desc45 );executeAction( id239, desc44, DialogModes.NO );// =======================================================var id55 = charIDToTypeID( "Mk  " );    var desc10 = new ActionDescriptor();    var id56 = charIDToTypeID( "null" );        var ref4 = new ActionReference();        var id57 = stringIDToTypeID( "slice" );        ref4.putClass( id57 );    desc10.putReference( id56, ref4 );    var id58 = charIDToTypeID( "Usng" );        var desc11 = new ActionDescriptor();        var id59 = charIDToTypeID( "Type" );        var id60 = stringIDToTypeID( "sliceType" );        var id61 = charIDToTypeID( "Lyr " );        desc11.putEnumerated( id59, id60, id61 );        var id62 = charIDToTypeID( "Lyr " );            var ref5 = new ActionReference();            var id63 = charIDToTypeID( "Lyr " );            var id64 = charIDToTypeID( "Ordn" );            var id65 = charIDToTypeID( "Trgt" );            ref5.putEnumerated( id63, id64, id65 );        desc11.putReference( id62, ref5 );    var id66 = stringIDToTypeID( "slice" );    desc10.putObject( id58, id66, desc11 );executeAction( id55, desc10, DialogModes.NO );// =======================================================var id142 = charIDToTypeID( "setd" );    var desc26 = new ActionDescriptor();    var id143 = charIDToTypeID( "null" );        var ref15 = new ActionReference();        var id144 = stringIDToTypeID( "slice" );        var id145 = charIDToTypeID( "Ordn" );        var id146 = charIDToTypeID( "Trgt" );        ref15.putEnumerated( id144, id145, id146 );    desc26.putReference( id143, ref15 );    var id147 = charIDToTypeID( "T   " );        var desc27 = new ActionDescriptor();        var id148 = charIDToTypeID( "Nm  " );        desc27.putString( id148, slice );        var id149 = stringIDToTypeID( "sliceImageType" );        var id150 = stringIDToTypeID( "sliceImageType" );        var id151 = charIDToTypeID( "Img " );        desc27.putEnumerated( id149, id150, id151 );    var id152 = stringIDToTypeID( "slice" );    desc26.putObject( id147, id152, desc27 );executeAction( id142, desc26, DialogModes.NO );}}try{var id2783 = charIDToTypeID( "slct" );    var desc593 = new ActionDescriptor();    var id2784 = charIDToTypeID( "null" );        var ref315 = new ActionReference();        var id2785 = charIDToTypeID( "Lyr " );        ref315.putName( id2785, "-----------------------------" );    desc593.putReference( id2784, ref315 );    var id2786 = charIDToTypeID( "MkVs" );    desc593.putBoolean( id2786, false );executeAction( id2783, desc593, DialogModes.NO );sliceLog();var id3570 = charIDToTypeID( "move" );    var desc758 = new ActionDescriptor();    var id3571 = charIDToTypeID( "null" );        var ref413 = new ActionReference();        var id3572 = charIDToTypeID( "Lyr " );        var id3573 = charIDToTypeID( "Ordn" );        var id3574 = charIDToTypeID( "Trgt" );        ref413.putEnumerated( id3572, id3573, id3574 );    desc758.putReference( id3571, ref413 );    var id3575 = charIDToTypeID( "T   " );        var ref414 = new ActionReference();        var id3576 = charIDToTypeID( "Lyr " );        var id3577 = charIDToTypeID( "Ordn" );        var id3578 = charIDToTypeID( "Frnt" );        ref414.putEnumerated( id3576, id3577, id3578 );    desc758.putReference( id3575, ref414 );executeAction( id3570, desc758, DialogModes.NO );}catch(e) {activeDocument.layerSets.add().name = "WEB レイヤー";// =======================================================var id3036 = charIDToTypeID( "setd" );    var desc649 = new ActionDescriptor();    var id3037 = charIDToTypeID( "null" );        var ref350 = new ActionReference();        var id3038 = charIDToTypeID( "Lyr " );        var id3039 = charIDToTypeID( "Ordn" );        var id3040 = charIDToTypeID( "Trgt" );        ref350.putEnumerated( id3038, id3039, id3040 );    desc649.putReference( id3037, ref350 );    var id3041 = charIDToTypeID( "T   " );        var desc650 = new ActionDescriptor();        var id3042 = charIDToTypeID( "Clr " );        var id3043 = charIDToTypeID( "Clr " );        var id3044 = charIDToTypeID( "Grn " );        desc650.putEnumerated( id3042, id3043, id3044 );    var id3045 = charIDToTypeID( "Lyr " );    desc649.putObject( id3041, id3045, desc650 );executeAction( id3036, desc649, DialogModes.NO );// NULLレイヤー作成var id2529 = charIDToTypeID( "Mk  " );    var desc534 = new ActionDescriptor();    var id2530 = charIDToTypeID( "null" );        var ref275 = new ActionReference();        var id2531 = charIDToTypeID( "Lyr " );        ref275.putClass( id2531 );    desc534.putReference( id2530, ref275 );    var id2532 = charIDToTypeID( "Usng" );        var desc535 = new ActionDescriptor();        var id2533 = charIDToTypeID( "Nm  " );        desc535.putString( id2533, "-----------------------------" );        var id2534 = charIDToTypeID( "Opct" );        var id2535 = charIDToTypeID( "#Prc" );        desc535.putUnitDouble( id2534, id2535, 0.000000 );    var id2536 = charIDToTypeID( "Lyr " );    desc534.putObject( id2532, id2536, desc535 );executeAction( id2529, desc534, DialogModes.NO );// NULLレイヤーロックvar id2537 = charIDToTypeID( "setd" );    var desc536 = new ActionDescriptor();    var id2538 = charIDToTypeID( "null" );        var ref276 = new ActionReference();        var id2539 = charIDToTypeID( "Lyr " );        var id2540 = charIDToTypeID( "Ordn" );        var id2541 = charIDToTypeID( "Trgt" );        ref276.putEnumerated( id2539, id2540, id2541 );    desc536.putReference( id2538, ref276 );    var id2542 = charIDToTypeID( "T   " );        var desc537 = new ActionDescriptor();        var id2543 = stringIDToTypeID( "layerLocking" );            var desc538 = new ActionDescriptor();            var id2544 = stringIDToTypeID( "protectAll" );            desc538.putBoolean( id2544, true );        var id2545 = stringIDToTypeID( "layerLocking" );        desc537.putObject( id2543, id2545, desc538 );    var id2546 = charIDToTypeID( "Lyr " );    desc536.putObject( id2542, id2546, desc537 );executeAction( id2537, desc536, DialogModes.NO );// =======================================================var idsetd = charIDToTypeID( "setd" );    var desc89 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref59 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        var idOrdn = charIDToTypeID( "Ordn" );        var idTrgt = charIDToTypeID( "Trgt" );        ref59.putEnumerated( idLyr, idOrdn, idTrgt );    desc89.putReference( idnull, ref59 );    var idT = charIDToTypeID( "T   " );        var desc90 = new ActionDescriptor();        var idClr = charIDToTypeID( "Clr " );        var idClr = charIDToTypeID( "Clr " );        var idGrn = charIDToTypeID( "Grn " );        desc90.putEnumerated( idClr, idClr, idGrn );    var idLyr = charIDToTypeID( "Lyr " );    desc89.putObject( idT, idLyr, desc90 );executeAction( idsetd, desc89, DialogModes.NO );sliceLog();}// =======================================================var id17148 = charIDToTypeID( "slct" );    var desc2172 = new ActionDescriptor();    var id17149 = charIDToTypeID( "null" );        var ref1150 = new ActionReference();        var id17150 = charIDToTypeID( "Lyr " );        ref1150.putName( id17150, "Dearps NULL" );    desc2172.putReference( id17149, ref1150 );    var id17151 = charIDToTypeID( "MkVs" );    desc2172.putBoolean( id17151, false );executeAction( id17148, desc2172, DialogModes.NO );// =======================================================var id17152 = charIDToTypeID( "Dlt " );    var desc2173 = new ActionDescriptor();    var id17153 = charIDToTypeID( "null" );        var ref1151 = new ActionReference();        var id17154 = charIDToTypeID( "Lyr " );        var id17155 = charIDToTypeID( "Ordn" );        var id17156 = charIDToTypeID( "Trgt" );        ref1151.putEnumerated( id17154, id17155, id17156 );    desc2173.putReference( id17153, ref1151 );executeAction( id17152, desc2173, DialogModes.NO );lsObj = activeDocument.layerSets["WEB レイヤー"];lsObj.opacity = 0;}catch(e) {    var idsetd = charIDToTypeID( "setd" );    var desc381 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref179 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idfsel = charIDToTypeID( "fsel" );        ref179.putProperty( idChnl, idfsel );    desc381.putReference( idnull, ref179 );    var idT = charIDToTypeID( "T   " );    var idOrdn = charIDToTypeID( "Ordn" );    var idNone = charIDToTypeID( "None" );    desc381.putEnumerated( idT, idOrdn, idNone );executeAction( idsetd, desc381, DialogModes.NO );// =======================================================var idDlt = charIDToTypeID( "Dlt " );    var desc395 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref187 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        var idOrdn = charIDToTypeID( "Ordn" );        var idTrgt = charIDToTypeID( "Trgt" );        ref187.putEnumerated( idLyr, idOrdn, idTrgt );    desc395.putReference( idnull, ref187 );executeAction( idDlt, desc395, DialogModes.NO );}